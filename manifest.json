{
  "manifest_version": 3,
  "name": "Aintivirus Privacy and Wallet",
  "version": "0.2.0",
  "description": "Aintivirus security extension",
  
  "__host_permissions_justification__": [
    "The <all_urls> host permission is REQUIRED for this extension because:",
    "1. dApp Provider Injection: Content script must inject window.ethereum/window.solana",
    "   provider on ANY web page that may be a dApp - cannot predict which sites are dApps",
    "2. Ad/Tracker Blocking: Privacy protection requires monitoring network requests on all sites",
    "3. Security Scanning: Phishing detection must analyze page content on any site user visits",
    "",
    "SECURITY MITIGATIONS in place:",
    "- Strict CSP prevents remote code execution",
    "- All message passing validates sender/origin",
    "- Content script has minimal privileges (only bridge, no wallet access)",
    "- Sensitive operations (signing, mnemonic) only in background service worker",
    "- No sensitive data in window.postMessage (only signed results)",
    "",
    "Alternative approaches considered but rejected:",
    "- optional_host_permissions: Would require user to grant per-site, breaking dApp UX",
    "- Narrower patterns: Cannot enumerate all possible dApp domains",
    "",
    "This field is for documentation only and is ignored by Chrome."
  ],
  
  "permissions": [
    "storage",
    "activeTab",
    "scripting",
    "declarativeNetRequest",
    "declarativeNetRequestFeedback",
    "cookies",
    "tabs",
    "webNavigation",
    "alarms",
    "notifications",
    "sidePanel",
    "browsingData"
  ],
  "host_permissions": [
    "<all_urls>"
  ],
  "declarative_net_request": {
    "rule_resources": [
      {
        "id": "ublock-filters",
        "enabled": true,
        "path": "ubol/rulesets/main/ublock-filters.json"
      },
      {
        "id": "easylist",
        "enabled": true,
        "path": "ubol/rulesets/main/easylist.json"
      },
      {
        "id": "easyprivacy",
        "enabled": true,
        "path": "ubol/rulesets/main/easyprivacy.json"
      },
      {
        "id": "pgl",
        "enabled": true,
        "path": "ubol/rulesets/main/pgl.json"
      },
      {
        "id": "ublock-badware",
        "enabled": true,
        "path": "ubol/rulesets/main/ublock-badware.json"
      },
      {
        "id": "urlhaus-full",
        "enabled": true,
        "path": "ubol/rulesets/main/urlhaus-full.json"
      },
      {
        "id": "adguard-mobile",
        "enabled": false,
        "path": "ubol/rulesets/main/adguard-mobile.json"
      },
      {
        "id": "block-lan",
        "enabled": false,
        "path": "ubol/rulesets/main/block-lan.json"
      },
      {
        "id": "dpollock-0",
        "enabled": false,
        "path": "ubol/rulesets/main/dpollock-0.json"
      },
      {
        "id": "adguard-spyware-url",
        "enabled": false,
        "path": "ubol/rulesets/main/adguard-spyware-url.json"
      },
      {
        "id": "annoyances-cookies",
        "enabled": false,
        "path": "ubol/rulesets/main/annoyances-cookies.json"
      },
      {
        "id": "annoyances-overlays",
        "enabled": true,
        "path": "ubol/rulesets/main/annoyances-overlays.json"
      },
      {
        "id": "annoyances-social",
        "enabled": false,
        "path": "ubol/rulesets/main/annoyances-social.json"
      },
      {
        "id": "annoyances-widgets",
        "enabled": false,
        "path": "ubol/rulesets/main/annoyances-widgets.json"
      },
      {
        "id": "annoyances-others",
        "enabled": true,
        "path": "ubol/rulesets/main/annoyances-others.json"
      },
      {
        "id": "annoyances-notifications",
        "enabled": false,
        "path": "ubol/rulesets/main/annoyances-notifications.json"
      },
      {
        "id": "ublock-experimental",
        "enabled": true,
        "path": "ubol/rulesets/main/ublock-experimental.json"
      },
      {
        "id": "stevenblack-hosts",
        "enabled": false,
        "path": "ubol/rulesets/main/stevenblack-hosts.json"
      }
    ]
  },
  "web_accessible_resources": [
    {
      "resources": [
        "fingerprintInjected.js",
        "securityInjected.js",
        "dappInpage.js",
        "popup.html",
        "icons/icon48.png",
        "empty.js",
        "noop.js",
        "noop-sentry.js",
        "noop-bugsnag.js"
      ],
      "matches": ["<all_urls>"]
    },
    {
      "resources": [
        "ubol/web_accessible_resources/*",
        "ubol/js/scripting/*",
        "ubol/rulesets/scripting/*"
      ],
      "matches": ["<all_urls>"],
      "use_dynamic_url": true
    }
  ],
  "background": {
    "service_worker": "background.js",
    "type": "module"
  },
  "content_scripts": [
    {
      "matches": ["<all_urls>"],
      "js": ["content.js"],
      "run_at": "document_start"
    }
  ],
  "action": {
    "default_icon": {
      "16": "icons/icon16.png",
      "48": "icons/icon48.png",
      "128": "icons/icon128.png"
    },
    "default_title": "Aintivirus Privacy Extension"
  },
  "side_panel": {
    "default_path": "popup.html"
  },
  "options_page": "settings.html",
  "icons": {
    "16": "icons/icon16.png",
    "48": "icons/icon48.png",
    "128": "icons/icon128.png"
  }
}

